#pragma once

#include <cmath>
#include <stdexcept>
#include <vector>

namespace kynema::math {

inline std::vector<double> GetGllLocations(size_t order) {
    switch (order) {
        case 1UL:
            return std::vector{-1., 1.};
        case 2UL:
            return std::vector{-1., 0., 1.};
        case 3UL:
            return std::vector{-1., -std::sqrt(1. / 5.), std::sqrt(1. / 5.), 1.};
        case 4UL:
            return std::vector{-1., -std::sqrt(3. / 7.), 0., std::sqrt(3. / 7.), 1.};
        case 5UL:
            return std::vector{
                -1.,
                -std::sqrt((1. / 3.) + (2. * std::sqrt(7.) / 21.)),
                -std::sqrt((1. / 3.) - (2. * std::sqrt(7.) / 21.)),
                std::sqrt((1. / 3.) - (2. * std::sqrt(7.) / 21.)),
                std::sqrt((1. / 3.) + (2. * std::sqrt(7.) / 21.)),
                1.
            };
        case 6UL:
            return std::vector{
                -1.,
                -std::sqrt((5. / 11.) + ((2. / 11.) * std::sqrt(5. / 3.))),
                -std::sqrt((5. / 11.) - ((2. / 11.) * std::sqrt(5. / 3.))),
                0.,
                std::sqrt((5. / 11.) - ((2. / 11.) * std::sqrt(5. / 3.))),
                std::sqrt((5. / 11.) + ((2. / 11.) * std::sqrt(5. / 3.))),
                1.
            };
        case 7UL:
            return std::vector{
                -1.,
                -0.87174014850960657,
                -0.59170018143314229,
                -0.20929921790247885,
                0.20929921790247885,
                0.59170018143314229,
                0.87174014850960657,
                1.
            };
        case 8UL:
            return std::vector{-1., -0.89975799541146018, -0.67718627951073773, -0.36311746382617816,
                               0.,  0.36311746382617816,  0.67718627951073773,  0.89975799541146018,
                               1.};
        case 9UL:
            return std::vector{
                -1.,
                -0.91953390816645886,
                -0.73877386510550502,
                -0.47792494981044453,
                -0.16527895766638701,
                0.16527895766638701,
                0.47792494981044448,
                0.73877386510550502,
                0.91953390816645886,
                1.
            };
        case 10UL:
            return std::vector{-1.,
                               -0.93400143040805916,
                               -0.78448347366314441,
                               -0.56523532699620493,
                               -0.29575813558693936,
                               0.,
                               0.29575813558693936,
                               0.56523532699620493,
                               0.78448347366314441,
                               0.93400143040805916,
                               1.};
        case 11UL:
            return std::vector{
                -1.,
                -0.94489927222288217,
                -0.81927932164400663,
                -0.63287615303186073,
                -0.39953094096534891,
                -0.13655293285492756,
                0.13655293285492756,
                0.39953094096534891,
                0.63287615303186073,
                0.81927932164400663,
                0.94489927222288217,
                1.
            };
        case 12UL:
            return std::vector{
                -1.,
                -0.95330984664216400,
                -0.84634756465187233,
                -0.68618846908175746,
                -0.48290982109133623,
                -0.24928693010623998,
                0.,
                0.24928693010623998,
                0.48290982109133623,
                0.68618846908175746,
                0.84634756465187233,
                0.95330984664216400,
                1.
            };
        case 13UL:
            return std::vector{
                -1.,
                -0.95993504526726092,
                -0.86780105383034722,
                -0.72886859909132617,
                -0.55063940292864699,
                -0.34272401334271285,
                -0.11633186888370387,
                0.11633186888370387,
                0.34272401334271285,
                0.55063940292864710,
                0.72886859909132617,
                0.86780105383034722,
                0.95993504526726092,
                1.
            };
        case 14UL:
            return std::vector{
                -1.,
                -0.96524592650383856,
                -0.88508204422297632,
                -0.76351968995181518,
                -0.60625320546984574,
                -0.42063805471367249,
                -0.21535395536379423,
                0.,
                0.21535395536379423,
                0.42063805471367249,
                0.60625320546984574,
                0.76351968995181518,
                0.88508204422297632,
                0.96524592650383856,
                1.
            };
        case 15UL:
            return std::vector{
                -1.,
                -0.96956804627021798,
                -0.89920053309347214,
                -0.79200829186181509,
                -0.65238870288249307,
                -0.48605942188713763,
                -0.29983046890076320,
                -0.10132627352194944,
                0.10132627352194944,
                0.29983046890076320,
                0.48605942188713763,
                0.65238870288249307,
                0.79200829186181509,
                0.89920053309347214,
                0.96956804627021798,
                1.
            };
        case 16UL:
            return std::vector{
                -1.0,
                -0.9731321766314183,
                -0.9108799959155736,
                -0.8156962512217704,
                -0.6910289806276847,
                -0.5413853993301015,
                -0.372174433565477,
                -0.1895119735183174,
                0.0,
                0.1895119735183174,
                0.372174433565477,
                0.5413853993301015,
                0.6910289806276847,
                0.8156962512217704,
                0.9108799959155736,
                0.9731321766314183,
                1.0
            };
        case 17UL:
            return std::vector{
                -1.0,
                -0.9761055574121985,
                -0.9206491853475339,
                -0.8355935352180902,
                -0.7236793292832426,
                -0.5885048343186617,
                -0.43441503691212396,  // NOLINT
                -0.266362652878281,
                -0.08974909348465213,
                0.08974909348465213,
                0.266362652878281,
                0.43441503691212396,  // NOLINT
                0.5885048343186617,
                0.7236793292832426,
                0.8355935352180902,
                0.9206491853475339,
                0.9761055574121985,
                1.0
            };
        case 18UL:
            return std::vector{
                -1.0,
                -0.9786117662220801,
                -0.9289015281525863,
                -0.8524605777966461,
                -0.751494202552613,
                -0.6289081372652205,
                -0.4882292856807135,
                -0.33350484782449863,
                -0.16918602340928157,
                0.0,
                0.16918602340928157,
                0.33350484782449863,
                0.4882292856807135,
                0.6289081372652205,
                0.751494202552613,
                0.8524605777966461,
                0.9289015281525863,
                0.9786117662220801,
                1.0
            };
        case 19UL:
            return std::vector{
                -1.0,
                -0.9807437048939142,
                -0.9359344988126654,
                -0.8668779780899502,
                -0.7753682609520559,
                -0.6637764022903113,
                -0.5349928640318863,
                -0.39235318371390926,
                -0.2395517059229865,
                -0.08054593723882184,
                0.08054593723882184,
                0.2395517059229865,
                0.39235318371390926,
                0.5349928640318863,
                0.6637764022903113,
                0.7753682609520559,
                0.8668779780899502,
                0.9359344988126654,
                0.9807437048939142,
                1.0
            };
        case 20UL:
            return std::vector{
                -1.0,
                -0.982572296604548,
                -0.9419762969597455,
                -0.8792947553235905,
                -0.7960019260777124,
                -0.6940510260622232,  // NOLINT
                -0.5758319602618307,
                -0.4441157832790021,
                -0.30198985650876486,
                -0.15278551580218547,
                0.0,
                0.15278551580218547,
                0.30198985650876486,
                0.4441157832790021,
                0.5758319602618307,
                0.6940510260622232,  // NOLINT
                0.7960019260777124,
                0.8792947553235905,
                0.9419762969597455,
                0.982572296604548,
                1.0
            };
        case 100UL:
            return std::vector{
                -1.0,
                -0.9992732578112129,
                -0.997564432044587,
                -0.9948806385217545,
                -0.9912247073833753,
                -0.9866002474942588,
                -0.9810117878154722,
                -0.9744647926317048,
                -0.9669656606203273,
                -0.9585217199147787,
                -0.9491412214185269,
                -0.9388333309390072,
                -0.9276081203214385,
                -0.9154765576522249,
                -0.9024504965657505,
                -0.8885426646755374,
                -0.873766651145992,
                -0.8581368934193241,
                -0.8416686631118906,
                -0.8243780510944396,
                -0.8062819517712353,
                -0.7873980465736545,
                -0.7677447866845291,
                -0.7473413750101983,
                -0.7262077474179458,
                -0.7043645532571894,
                -0.6818331351834797,
                -0.6586355083050388,
                -0.6347943386722272,
                -0.6103329211309613,
                -0.5852751565617291,
                -0.5596455285264476,
                -0.5334690793459793,
                -0.5067713856316896,
                -0.4795785332949497,
                -0.4519170920590072,
                -0.4238140894981276,
                -0.39529698462937374,
                -0.3663936410828277,
                -0.33713229987646925,
                -0.30754155182231335,
                -0.2776503095907678,
                -0.24748777946050743,
                -0.21708343278146724,
                -0.18646697717883803,
                -0.15566832752620036,
                -0.12471757671615918,
                -0.0936449662570384,
                -0.06248085672436486,
                -0.03125569809601377,
                0.0,
                0.03125569809601377,
                0.06248085672436486,
                0.0936449662570384,
                0.12471757671615918,
                0.15566832752620036,
                0.18646697717883803,
                0.21708343278146724,
                0.24748777946050743,
                0.2776503095907678,
                0.30754155182231335,
                0.33713229987646925,
                0.3663936410828277,
                0.39529698462937374,
                0.4238140894981276,
                0.4519170920590072,
                0.4795785332949497,
                0.5067713856316896,
                0.5334690793459793,
                0.5596455285264476,
                0.5852751565617291,
                0.6103329211309613,
                0.6347943386722272,
                0.6586355083050388,
                0.6818331351834797,
                0.7043645532571894,
                0.7262077474179458,
                0.7473413750101983,
                0.7677447866845291,
                0.7873980465736545,
                0.8062819517712353,
                0.8243780510944396,
                0.8416686631118906,
                0.8581368934193241,
                0.873766651145992,
                0.8885426646755374,
                0.9024504965657505,
                0.9154765576522249,
                0.9276081203214385,
                0.9388333309390072,
                0.9491412214185269,
                0.9585217199147787,
                0.9669656606203273,
                0.9744647926317048,
                0.9810117878154722,
                0.9866002474942588,
                0.9912247073833753,
                0.9948806385217545,
                0.997564432044587,
                0.9992732578112129,
                1.0,
            };
        default:
            throw std::runtime_error("Supported orders are 1 - 20");
    }
}

inline std::vector<double> GetGllWeights(size_t order) {
    switch (order) {
        case 1UL:
            return std::vector{1., 1.};
        case 2UL:
            return std::vector{1. / 3., 4. / 3., 1. / 3.};
        case 3UL:
            return std::vector{1. / 6., 5. / 6., 5. / 6., 1. / 6.};
        case 4UL:
            return std::vector{1. / 10., 49. / 90., 32. / 45., 49. / 90., 1. / 10.};
        case 5UL:
            return std::vector{
                1. / 15.,
                (14. - std::sqrt(7.)) / 30.,
                (14. + std::sqrt(7.)) / 30.,
                (14. + std::sqrt(7.)) / 30.,
                (14. - std::sqrt(7.)) / 30.,
                1. / 15.
            };
        case 6UL:
            return std::vector{1. / 21.,
                               (124. - 7. * std::sqrt(15.)) / 350.,
                               (124. + 7. * std::sqrt(15.)) / 350.,
                               256. / 525.,
                               (124. + 7. * std::sqrt(15.)) / 350.,
                               (124. - 7. * std::sqrt(15.)) / 350,
                               1. / 21.};
        case 7UL:
            return std::vector{3.5714285714285712E-002, 0.21070422714350615,    0.34112269248350441,
                               0.41245879465870372,     0.41245879465870372,    0.34112269248350441,
                               0.21070422714350615,     3.5714285714285712E-002};
        case 8UL:
            return std::vector{2.7777777777777776E-002, 0.16549536156080552,
                               0.27453871250016160,     0.34642851097304617,
                               0.37151927437641724,     0.34642851097304617,
                               0.27453871250016160,     0.16549536156080552,
                               2.7777777777777776E-002};
        case 9UL:
            return std::vector{2.2222222222222223E-002, 0.13330599085107006, 0.22488934206312636,
                               0.29204268367968378,     0.32753976118389744, 0.32753976118389744,
                               0.29204268367968378,     0.22488934206312636, 0.13330599085107006,
                               2.2222222222222223E-002};
        case 10UL:
            return std::vector{1.8181818181818181E-002, 0.10961227326699498,    0.18716988178030541,
                               0.24804810426402829,     0.28687912477900801,    0.30021759545569071,
                               0.28687912477900823,     0.24804810426402829,    0.18716988178030541,
                               0.10961227326699498,     1.8181818181818181E-002};
        case 11UL:
            return std::vector{1.5151515151515152E-002, 9.1684517413196109E-002,
                               0.15797470556437004,     0.21250841776102122,
                               0.25127560319920106,     0.27140524091069618,
                               0.27140524091069618,     0.25127560319920106,
                               0.21250841776102122,     0.15797470556437004,
                               9.1684517413196109E-002, 1.5151515151515152E-002};
        case 12UL:
            return std::vector{1.2820512820512820E-002, 7.7801686746818866E-002,
                               0.13498192668960840,     0.18364686520355006,
                               0.22076779356611012,     0.24401579030667625,
                               0.25193084933344673,     0.24401579030667625,
                               0.22076779356611012,     0.18364686520355006,
                               0.13498192668960840,     7.7801686746818866E-002,
                               1.2820512820512820E-002};
        case 13UL:
            return std::vector{1.0989010989010990E-002, 6.6837284497681185E-002, 0.11658665589871173,
                               0.16002185176295217,     0.19482614937341614,     0.21912625300977098,
                               0.23161279446845698,     0.23161279446845698,     0.21912625300977098,
                               0.19482614937341600,     0.16002185176295217,     0.11658665589871173,
                               6.6837284497681185E-002, 1.0989010989010990E-002};
        case 14UL:
            return std::vector{
                9.5238095238095247E-003, 5.8029893028601086E-002, 0.10166007032571801,
                0.14051169980242798,     0.17278964725360088,     0.19698723596461334,
                0.21197358592682095,     0.21704811634881566,     0.21197358592682075,
                0.19698723596461334,     0.17278964725360088,     0.14051169980242798,
                0.10166007032571801,     5.8029893028601086E-002, 9.5238095238095247E-003
            };
        case 15UL:
            return std::vector{8.3333333333333332E-003, 5.0850361005920039E-002,
                               8.9393697325930832E-002, 0.12425538213251400,
                               0.15402698080716443,     0.17749191339170411,
                               0.19369002382520362,     0.20195830817822993,
                               0.20195830817822993,     0.19369002382520362,
                               0.17749191339170411,     0.15402698080716443,
                               0.12425538213251400,     8.9393697325930832E-002,
                               5.0850361005920039E-002, 8.3333333333333332E-003};
        case 16UL:
            return std::vector{0.007352941176470588, 0.04492194054325405, 0.0791982705036871,
                               0.11059290900702815,  0.13798774620192658, 0.16039466199762148,
                               0.1770042535156577,   0.18721633967761928, 0.19066187475346943,
                               0.18721633967761928,  0.1770042535156577,  0.16039466199762148,
                               0.13798774620192658,  0.11059290900702815, 0.0791982705036871,
                               0.04492194054325405,  0.007352941176470588};
        case 17UL:
            return std::vector{0.006535947712418301, 0.03997062881091395, 0.07063716688563365,
                               0.09901627171750278,  0.12421053313296708, 0.14541196157380232,
                               0.16193951723760242,  0.17326210948945636, 0.17901586343970305,
                               0.17901586343970305,  0.17326210948945636, 0.16193951723760242,
                               0.14541196157380232,  0.12421053313296708, 0.09901627171750278,
                               0.07063716688563365,  0.03997062881091395, 0.006535947712418301};
        case 18UL:
            return std::vector{0.005847953216374269, 0.035793365186176644, 0.06338189176262979,
                               0.08913175709920705,  0.11231534147730492,  0.1322672804487507,
                               0.14841394259593885,  0.1602909240440612,   0.16755658452714278,
                               0.17000191928482725,  0.16755658452714278,  0.1602909240440612,
                               0.14841394259593885,  0.1322672804487507,   0.11231534147730492,
                               0.08913175709920705,  0.06338189176262979,  0.035793365186176644,
                               0.005847953216374269};
        case 19UL:
            return std::vector{0.005263157894736842, 0.03223712318848893, 0.0571818021275668,
                               0.08063176399611967,  0.10199149969945068, 0.12070922762867466,
                               0.13630048235872422,  0.14836155407091683, 0.15658010264747543,
                               0.16074328638784569,  0.16074328638784569, 0.15658010264747543,
                               0.14836155407091683,  0.13630048235872422, 0.12070922762867466,
                               0.10199149969945068,  0.08063176399611967, 0.0571818021275668,
                               0.03223712318848893,  0.005263157894736842};
        case 20UL:
            return std::vector{0.004761904761904762, 0.029184840098505565, 0.05184316900084964,
                               0.07327391818507417,  0.092985467957886,    0.11051708321912326,
                               0.1254581211908689,   0.1374584628600413,   0.14623686244797737,
                               0.15158757511168136,  0.15338519033217496,  0.15158757511168136,
                               0.14623686244797737,  0.1374584628600413,   0.1254581211908689,
                               0.11051708321912326,  0.092985467957886,    0.07327391818507417,
                               0.05184316900084964,  0.029184840098505565, 0.004761904761904762};
        case 100UL:
            return std::vector{0.00019801980198019803, 0.0012204276494756096, 0.0021967379918678047,
                               0.0031703893238251937,  0.004140872623634033,  0.005107292474504979,
                               0.00606871613662751,    0.007024207698695935,  0.00797283485601666,
                               0.008913671273050698,   0.009845797936967065,  0.01076830421785277,
                               0.011680288824616627,   0.012580860715228265,  0.013469139981628431,
                               0.014344258716811612,   0.015205361866815714,  0.016051608068429056,
                               0.01688217047259503,    0.017696237553117427,  0.018493013900093766,
                               0.01927172099742115,    0.02003159798368662,   0.02077190239573547,
                               0.021491910894219514,   0.022190919970428696,  0.022868246633728155,
                               0.02352322907893218,    0.024155227332968956,  0.02476362388020823,
                               0.025347824265839494,   0.025907257676715513,  0.0264413774990937,
                               0.02694966185272911,    0.02743161410080139,   0.027886763335174196,
                               0.028314664836515926,   0.028714900508829515,  0.02908707928797069,
                               0.029430837523751276,   0.02974583933525808,   0.03003177693903739,
                               0.03028837094982707,    0.030515370653539507,  0.030712554252231405,
                               0.030879729080819606,   0.031016731795331418,  0.031123428532505784,
                               0.031199715040589396,   0.03124551678119947,   0.03126078900215414,
                               0.03124551678119947,    0.031199715040589396,  0.031123428532505784,
                               0.031016731795331418,   0.030879729080819606,  0.030712554252231405,
                               0.030515370653539507,   0.03028837094982707,   0.03003177693903739,
                               0.02974583933525808,    0.029430837523751276,  0.02908707928797069,
                               0.028714900508829515,   0.028314664836515926,  0.027886763335174196,
                               0.02743161410080139,    0.02694966185272911,   0.0264413774990937,
                               0.025907257676715513,   0.025347824265839494,  0.02476362388020823,
                               0.024155227332968956,   0.02352322907893218,   0.022868246633728155,
                               0.022190919970428696,   0.021491910894219514,  0.02077190239573547,
                               0.02003159798368662,    0.01927172099742115,   0.018493013900093766,
                               0.017696237553117427,   0.01688217047259503,   0.016051608068429056,
                               0.015205361866815714,   0.014344258716811612,  0.013469139981628431,
                               0.012580860715228265,   0.011680288824616627,  0.01076830421785277,
                               0.009845797936967065,   0.008913671273050698,  0.00797283485601666,
                               0.007024207698695935,   0.00606871613662751,   0.005107292474504979,
                               0.004140872623634033,   0.0031703893238251937, 0.0021967379918678047,
                               0.0012204276494756096,  0.00019801980198019803};
        default:
            throw std::runtime_error("Supported orders are 1 - 20");
    }
}

}  // namespace kynema::math
